(()=>{var e={};e.id=761,e.ids=[761],e.modules={5486:e=>{"use strict";e.exports=require("bcrypt")},846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},5511:e=>{"use strict";e.exports=require("crypto")},9021:e=>{"use strict";e.exports=require("fs")},1645:e=>{"use strict";e.exports=require("net")},1820:e=>{"use strict";e.exports=require("os")},3873:e=>{"use strict";e.exports=require("path")},4998:e=>{"use strict";e.exports=require("perf_hooks")},7910:e=>{"use strict";e.exports=require("stream")},4631:e=>{"use strict";e.exports=require("tls")},71:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>f,routeModule:()=>x,serverHooks:()=>N,workAsyncStorage:()=>y,workUnitAsyncStorage:()=>h});var s={};r.r(s),r.d(s,{POST:()=>m});var o=r(2706),a=r(8203),n=r(5994),i=r(9187),l=r(3345),u=r(8474),d=r(7579),c=r(5486),p=r.n(c);async function m(e){try{let{login:t,password:r}=await e.json();if(!t||!r)return i.NextResponse.json({error:"Login and password are required"},{status:400});let s=await l.db.select().from(u.Vy).where((0,d.or)((0,d.eq)(u.Vy.username,t),(0,d.eq)(u.Vy.email,t))).limit(1).execute();if(!s||0===s.length)return i.NextResponse.json({error:"Invalid credentials"},{status:401});let o=s[0];if(!await p().compare(r,o.password))return i.NextResponse.json({error:"Invalid credentials"},{status:401});let a=await l.db.select().from(u.GS).where((0,d.eq)(u.GS.userId,o.id)).execute(),n=a.length>0?a[0].id:null;return i.NextResponse.json({userId:o.id,name:o.name,role:o.role,hostId:n},{status:200})}catch(e){return console.error("Login error:",e),i.NextResponse.json({error:"Failed to authenticate user"},{status:500})}}let x=new o.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/login/route",pathname:"/api/login",filename:"route",bundlePath:"app/api/login/route"},resolvedPagePath:"/Users/deekshithmac/Desktop/home-stay/easy-stay/src/app/api/login/route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:y,workUnitAsyncStorage:h,serverHooks:N}=x;function f(){return(0,n.patchFetch)({workAsyncStorage:y,workUnitAsyncStorage:h})}},6487:()=>{},8335:()=>{},3345:(e,t,r)=>{"use strict";r.d(t,{db:()=>i});var s=r(5482),o=r(6675),a=r(3186);(0,s.config)({path:".env"});let n=(0,a.A)(process.env.DATABASE_URL),i=(0,o.f)({client:n})},8474:(e,t,r)=>{"use strict";r.d(t,{GS:()=>d,Vy:()=>u,mO:()=>c});var s=r(7328),o=r(9516),a=r(4799),n=r(2590),i=r(9848),l=r(7102);let u=(0,s.cJ)("users_table",{id:(0,o.vX)("id").primaryKey(),name:(0,a.Qq)("name").notNull(),username:(0,a.Qq)("username").notNull().unique(),email:(0,a.Qq)("email").notNull().unique(),password:(0,a.Qq)("password").notNull(),role:(0,a.Qq)("role").notNull().default("user"),createdAt:(0,n.vE)("created_at").notNull().defaultNow()}),d=(0,s.cJ)("hosts_table",{id:(0,o.vX)("id").primaryKey(),userId:(0,i.nd)("user_id").notNull().references(()=>u.id,{onDelete:"cascade"}),propertyIds:(0,l.Fx)("property_ids").notNull().default([])}),c=(0,s.cJ)("homestays_table",{id:(0,o.vX)("id").primaryKey(),hostId:(0,i.nd)("host_id").notNull().references(()=>d.id,{onDelete:"cascade"}),name:(0,a.Qq)("name").notNull(),description:(0,a.Qq)("description"),photos:(0,l.Fx)("photos").notNull().default([]),location:(0,l.Fx)("location").notNull(),pricePerNight:(0,i.nd)("price_per_night").notNull(),amenities:(0,l.Fx)("amenities").notNull().default([]),rating:(0,i.nd)("rating").default(0),availability:(0,l.Fx)("availability").notNull(),createdAt:(0,n.vE)("created_at").notNull().defaultNow(),updatedAt:(0,n.vE)("updated_at").notNull().$onUpdate(()=>new Date)});(0,s.cJ)("bookings_table",{id:(0,o.vX)("id").primaryKey(),userId:(0,i.nd)("user_id").notNull().references(()=>u.id,{onDelete:"cascade"}),homestayId:(0,i.nd)("homestay_id").notNull().references(()=>c.id,{onDelete:"cascade"}),checkIn:(0,n.vE)("check_in").notNull(),checkOut:(0,n.vE)("check_out").notNull(),totalPrice:(0,i.nd)("total_price").notNull(),foodSelection:(0,l.Fx)("food_selection").default([]),status:(0,a.Qq)("status").default("confirmed")}),(0,s.cJ)("menu_items_table",{id:(0,o.vX)("id").primaryKey(),homestayId:(0,i.nd)("homestay_id").notNull().references(()=>c.id,{onDelete:"cascade"}),name:(0,a.Qq)("name").notNull(),description:(0,a.Qq)("description"),price:(0,i.nd)("price").notNull(),type:(0,a.Qq)("type").notNull()}),(0,s.cJ)("chats_table",{id:(0,o.vX)("id").primaryKey(),userId:(0,i.nd)("user_id").notNull().references(()=>u.id,{onDelete:"cascade"}),hostId:(0,i.nd)("host_id").notNull().references(()=>d.id,{onDelete:"cascade"}),messages:(0,l.Fx)("messages").notNull().default([])})}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[638,452,884],()=>r(71));module.exports=s})();